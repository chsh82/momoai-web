{% extends "base.html" %}

{% block title %}ë„ì„œ ìë£Œì‹¤ - MOMOAI v4.0{% endblock %}

{% block content %}
<div class="max-w-7xl mx-auto">
    <!-- Header -->
    <div class="mb-8">
        <h2 class="text-3xl font-bold text-gray-800">ğŸ“š í•™ìŠµ ìë£Œì‹¤</h2>
        <p class="text-gray-600 mt-2">í•™ìŠµì— ë„ì›€ì´ ë˜ëŠ” ë‹¤ì–‘í•œ ìë£Œë¥¼ í•œ ê³³ì—ì„œ ë§Œë‚˜ë³´ì„¸ìš”</p>
    </div>

    <!-- 1. ìœ íŠœë¸Œ ì˜ìƒ ì„¹ì…˜ -->
    <div class="bg-white rounded-lg shadow p-6 mb-8">
        <div class="flex items-center justify-between mb-6">
            <h3 class="text-2xl font-bold text-gray-800">ğŸ¬ ìœ íŠœë¸Œ ì˜ìƒ ìë£Œ</h3>
            <a href="{{ url_for('library.videos') }}"
               class="text-blue-600 hover:text-blue-800 font-medium">
                ëª¨ë‘ ë³´ê¸° â†’
            </a>
        </div>

        {% if latest_videos %}
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
            {% for video in latest_videos %}
            <a href="{{ url_for('library.video_detail', video_id=video.video_id) }}"
               class="block group">
                <div class="bg-gray-100 rounded-lg overflow-hidden aspect-video relative">
                    {% if video.youtube_video_id %}
                    <img src="https://img.youtube.com/vi/{{ video.youtube_video_id }}/mqdefault.jpg"
                         alt="{{ video.title }}"
                         class="w-full h-full object-cover group-hover:scale-105 transition duration-300">
                    {% else %}
                    <div class="w-full h-full flex items-center justify-center">
                        <span class="text-4xl">ğŸ¬</span>
                    </div>
                    {% endif %}
                    <div class="absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-30 transition duration-300 flex items-center justify-center">
                        <span class="text-white text-4xl opacity-0 group-hover:opacity-100 transition duration-300">â–¶</span>
                    </div>
                </div>
                <h4 class="mt-3 font-semibold text-gray-800 group-hover:text-blue-600 transition duration-200 line-clamp-2">
                    {{ video.title }}
                </h4>
                <p class="text-sm text-gray-500 mt-1">ì¡°íšŒìˆ˜ {{ video.view_count }}</p>
            </a>
            {% endfor %}
        </div>
        {% else %}
        <p class="text-center text-gray-500 py-12">ë“±ë¡ëœ ì˜ìƒì´ ì—†ìŠµë‹ˆë‹¤.</p>
        {% endif %}
    </div>

    <!-- 2. ì¶”ì²œë„ì„œ ì„¹ì…˜ -->
    <div class="bg-white rounded-lg shadow p-6 mb-8">
        <div class="flex items-center justify-between mb-6">
            <h3 class="text-2xl font-bold text-gray-800">ğŸ“– ì¶”ì²œë„ì„œ</h3>
            <a href="{{ url_for('library.books') }}"
               class="text-blue-600 hover:text-blue-800 font-medium">
                ëª¨ë‘ ë³´ê¸° â†’
            </a>
        </div>

        {% if recommended_books %}
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
            {% for book in recommended_books %}
            <a href="{{ url_for('library.book_detail', book_id=book.book_id) }}"
               class="block group">
                <div class="bg-gray-100 rounded-lg overflow-hidden aspect-[3/4] flex items-center justify-center relative">
                    <span class="text-6xl">ğŸ“•</span>
                    {% if book.is_curriculum or book.is_recommended %}
                    <div class="absolute top-2 left-2 flex flex-col gap-1">
                        {% if book.is_curriculum %}
                        <span class="px-2 py-0.5 bg-blue-600 text-white text-xs font-bold rounded shadow">ìˆ˜ì—…ë„ì„œ</span>
                        {% endif %}
                        {% if book.is_recommended %}
                        <span class="px-2 py-0.5 bg-green-600 text-white text-xs font-bold rounded shadow">ì¶”ì²œë„ì„œ</span>
                        {% endif %}
                    </div>
                    {% endif %}
                </div>
                <h4 class="mt-3 font-semibold text-gray-800 group-hover:text-blue-600 transition duration-200 line-clamp-2">
                    {{ book.title }}
                </h4>
                <p class="text-sm text-gray-600 mt-1">{{ book.author }}</p>
                {% if book.avg_score %}
                <div class="flex items-center gap-0.5 mt-1">
                    {% set full_stars = book.avg_score | round | int %}
                    {% for i in range(1, 6) %}
                        <span class="{% if i <= full_stars %}text-yellow-400{% else %}text-gray-300{% endif %} text-xs">â˜…</span>
                    {% endfor %}
                    <span class="text-xs text-gray-500 ml-1">{{ book.avg_score }}</span>
                </div>
                {% endif %}
            </a>
            {% endfor %}
        </div>
        {% else %}
        <p class="text-center text-gray-500 py-12">ë“±ë¡ëœ ì¶”ì²œë„ì„œê°€ ì—†ìŠµë‹ˆë‹¤.</p>
        {% endif %}
    </div>

    <!-- 3. ëª…ì˜ˆì˜ ì „ë‹¹ ì„¹ì…˜ -->
    <div class="bg-white rounded-lg shadow p-6 mb-8">
        <div class="flex items-center justify-between mb-6">
            <h3 class="text-2xl font-bold text-gray-800">ğŸ† ëª…ì˜ˆì˜ ì „ë‹¹</h3>
            <a href="{{ url_for('library.hall_of_fame') }}"
               class="text-blue-600 hover:text-blue-800 font-medium">
                ëª¨ë‘ ë³´ê¸° â†’
            </a>
        </div>

        {% if hall_of_fame_posts %}
        <div class="space-y-4">
            {% for post in hall_of_fame_posts %}
            <a href="{{ url_for('library.hall_of_fame_detail', post_id=post.post_id) }}"
               class="block border border-gray-200 rounded-lg p-4 hover:border-blue-500 hover:shadow-md transition duration-200">
                <div class="flex items-start justify-between">
                    <div class="flex-1">
                        <div class="flex items-center gap-2 mb-2">
                            {% if post.category == 'excellent_answer' %}
                            <span class="bg-yellow-100 text-yellow-800 text-xs font-bold px-2 py-1 rounded">ìš°ìˆ˜ë‹µì•ˆ</span>
                            {% elif post.category == 'mock_exam_award' %}
                            <span class="bg-purple-100 text-purple-800 text-xs font-bold px-2 py-1 rounded">ëª¨ì˜ê³ ì‚¬</span>
                            {% elif post.category == 'essay_award' %}
                            <span class="bg-green-100 text-green-800 text-xs font-bold px-2 py-1 rounded">ìˆ˜ìƒì‘</span>
                            {% endif %}
                            <h4 class="font-semibold text-gray-800">{{ post.title }}</h4>
                        </div>
                        <div class="flex items-center gap-3 text-sm text-gray-600">
                            {% if post.student_name %}
                            <span>ğŸ‘¤ {{ post.student_name }}</span>
                            {% endif %}
                            {% if post.grade %}
                            <span>ğŸ“š {{ post.grade }}</span>
                            {% endif %}
                            <span>ğŸ‘ï¸ {{ post.view_count }}</span>
                        </div>
                    </div>
                </div>
            </a>
            {% endfor %}
        </div>
        {% else %}
        <p class="text-center text-gray-500 py-12">ë“±ë¡ëœ ê²Œì‹œê¸€ì´ ì—†ìŠµë‹ˆë‹¤.</p>
        {% endif %}
    </div>

    <!-- 4. ì…ì‹œì •ë³´ ì„¹ì…˜ -->
    <div class="bg-white rounded-lg shadow p-6 mb-8">
        <div class="flex items-center justify-between mb-6">
            <h3 class="text-2xl font-bold text-gray-800">ğŸ“‹ ì…ì‹œì •ë³´</h3>
            <a href="{{ url_for('library.admission_info') }}"
               class="text-blue-600 hover:text-blue-800 font-medium">
                ëª¨ë‘ ë³´ê¸° â†’
            </a>
        </div>

        {% if admission_posts %}
        <div class="space-y-4">
            {% for post in admission_posts %}
            <a href="{{ url_for('library.admission_info_detail', post_id=post.post_id) }}"
               class="block border border-gray-200 rounded-lg p-4 hover:border-blue-500 hover:shadow-md transition duration-200">
                <div class="flex items-start justify-between">
                    <div class="flex-1">
                        <div class="flex items-center gap-2 mb-2">
                            {% if post.is_important %}
                            <span class="bg-red-100 text-red-800 text-xs font-bold px-2 py-1 rounded">ì¤‘ìš”</span>
                            {% endif %}
                            {% if post.category == 'university' %}
                            <span class="bg-blue-100 text-blue-800 text-xs font-bold px-2 py-1 rounded">ëŒ€í•™</span>
                            {% elif post.category == 'high_school' %}
                            <span class="bg-green-100 text-green-800 text-xs font-bold px-2 py-1 rounded">ê³ ë“±í•™êµ</span>
                            {% elif post.category == 'policy' %}
                            <span class="bg-purple-100 text-purple-800 text-xs font-bold px-2 py-1 rounded">ì •ì±…</span>
                            {% endif %}
                            <h4 class="font-semibold text-gray-800">{{ post.title }}</h4>
                        </div>
                        <div class="flex items-center gap-3 text-sm text-gray-600">
                            <span>ğŸ“… {{ post.created_at.strftime('%Y-%m-%d') }}</span>
                            <span>ğŸ‘ï¸ {{ post.view_count }}</span>
                        </div>
                    </div>
                </div>
            </a>
            {% endfor %}
        </div>
        {% else %}
        <p class="text-center text-gray-500 py-12">ë“±ë¡ëœ ì…ì‹œì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.</p>
        {% endif %}
    </div>
</div>
{% endblock %}
