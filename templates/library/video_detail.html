{% extends "base.html" %}

{% block title %}{{ video.title }} - MOMOAI v4.0{% endblock %}

{% block content %}
<div class="max-w-5xl mx-auto">
    <!-- Header -->
    <div class="mb-6">
        <h2 class="text-3xl font-bold text-gray-800 mb-2">{{ video.title }}</h2>
        <div class="flex items-center space-x-4 text-sm text-gray-600">
            <span>ğŸ“… {{ video.created_at.strftime('%Y-%m-%d') }}</span>
            <span>ğŸ‘ï¸ ì¡°íšŒìˆ˜ {{ video.view_count }}</span>
        </div>
    </div>

    <!-- Video Player -->
    <div class="bg-white rounded-lg shadow overflow-hidden mb-8">
        {% if video.youtube_video_id %}
        <div class="aspect-video">
            <iframe
                width="100%"
                height="100%"
                src="https://www.youtube.com/embed/{{ video.youtube_video_id }}"
                title="{{ video.title }}"
                frameborder="0"
                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                allowfullscreen
                class="w-full h-full">
            </iframe>
        </div>
        {% else %}
        <div class="aspect-video bg-gray-100 flex items-center justify-center">
            <div class="text-center">
                <span class="text-6xl mb-4 block">ğŸ¬</span>
                <p class="text-gray-500">ì˜ìƒì„ ì¬ìƒí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>
            </div>
        </div>
        {% endif %}
    </div>

    <!-- Video Info -->
    <div class="bg-white rounded-lg shadow p-6 mb-8">
        <h3 class="text-xl font-bold text-gray-800 mb-4">ì˜ìƒ ì •ë³´</h3>
        <div class="space-y-3">
            {% if video.description %}
            <div>
                <label class="font-semibold text-gray-700">ì„¤ëª…:</label>
                <p class="text-gray-600 mt-1 whitespace-pre-wrap">{{ video.description }}</p>
            </div>
            {% endif %}
            {% if video.grade %}
            <div>
                <label class="font-semibold text-gray-700">ëŒ€ìƒ í•™ë…„:</label>
                <span class="ml-2 text-gray-600">{{ video.grade }}</span>
            </div>
            {% endif %}
            <div>
                <label class="font-semibold text-gray-700">YouTube URL:</label>
                <a href="{{ video.youtube_url }}"
                   target="_blank"
                   class="ml-2 text-blue-600 hover:text-blue-800 hover:underline">
                    {{ video.youtube_url }}
                </a>
            </div>
        </div>
    </div>

    <!-- Admin Edit Button -->
    {% if current_user.role == 'admin' %}
    <div class="bg-gray-50 border border-gray-200 rounded-lg p-4 mb-6">
        <div class="flex items-center justify-between">
            <span class="text-sm text-gray-600">ê´€ë¦¬ì ì „ìš©</span>
            <div class="space-x-2">
                <a href="{{ url_for('library.edit_video', video_id=video.video_id) }}"
                   class="px-4 py-2 bg-yellow-600 text-white rounded-md hover:bg-yellow-700 transition duration-200">
                    ìˆ˜ì •
                </a>
                <button onclick="if(confirm('ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) { document.getElementById('deleteForm').submit(); }"
                        class="px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition duration-200">
                    ì‚­ì œ
                </button>
            </div>
        </div>
        <form id="deleteForm"
              action="{{ url_for('library.delete_video', video_id=video.video_id) }}"
              method="POST"
              class="hidden">
        </form>
    </div>
    {% endif %}

    <!-- Action Buttons -->
    <div class="flex justify-center space-x-4">
        <a href="{{ url_for('library.videos') }}"
           class="px-6 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition duration-200">
            â† ëª©ë¡ìœ¼ë¡œ
        </a>
        <a href="{{ video.youtube_url }}"
           target="_blank"
           class="px-6 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition duration-200">
            YouTubeì—ì„œ ë³´ê¸° â†’
        </a>
    </div>
</div>
{% endblock %}
