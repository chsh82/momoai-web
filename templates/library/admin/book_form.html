{% extends "base.html" %}

{% block title %}{% if book %}도서 수정{% else %}도서 등록{% endif %} - MOMOAI v4.0{% endblock %}

{% block content %}
<div class="max-w-5xl mx-auto">
    <!-- Header -->
    <div class="mb-8">
        <h2 class="text-3xl font-bold text-gray-800">
            {% if book %}📖 추천도서 수정{% else %}📖 추천도서 등록{% endif %}
        </h2>
        <p class="text-gray-600 mt-2">학생들에게 추천할 도서를 등록하세요</p>
    </div>

    <!-- Form -->
    <form method="POST" class="bg-white rounded-lg shadow p-8">
        <!-- Title -->
        <div class="mb-6">
            <label class="block text-sm font-semibold text-gray-700 mb-2">
                도서명 <span class="text-red-500">*</span>
            </label>
            <input type="text"
                   name="title"
                   value="{% if book %}{{ book.title }}{% endif %}"
                   required
                   maxlength="500"
                   class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                   placeholder="도서 제목을 입력하세요">
        </div>

        <!-- Author -->
        <div class="mb-6">
            <label class="block text-sm font-semibold text-gray-700 mb-2">
                저자 <span class="text-red-500">*</span>
            </label>
            <input type="text"
                   name="author"
                   value="{% if book %}{{ book.author or '' }}{% endif %}"
                   required
                   maxlength="200"
                   class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                   placeholder="저자명을 입력하세요">
        </div>

        <!-- Publisher and Year -->
        <div class="grid grid-cols-2 gap-4 mb-6">
            <div>
                <label class="block text-sm font-semibold text-gray-700 mb-2">
                    출판사
                </label>
                <input type="text"
                       name="publisher"
                       value="{% if book %}{{ book.publisher or '' }}{% endif %}"
                       maxlength="200"
                       class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                       placeholder="출판사명">
            </div>
            <div>
                <label class="block text-sm font-semibold text-gray-700 mb-2">
                    출판년도
                </label>
                <input type="number"
                       name="publication_year"
                       value="{% if book %}{{ book.publication_year or '' }}{% endif %}"
                       min="1900"
                       max="2100"
                       class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                       placeholder="2024">
            </div>
        </div>

        <!-- ISBN -->
        <div class="mb-6">
            <label class="block text-sm font-semibold text-gray-700 mb-2">
                ISBN
            </label>
            <input type="text"
                   name="isbn"
                   value="{% if book %}{{ book.isbn or '' }}{% endif %}"
                   maxlength="20"
                   class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                   placeholder="978-89-xxxxx-xx-x">
        </div>

        <!-- Category -->
        <div class="mb-6">
            <label class="block text-sm font-semibold text-gray-700 mb-2">
                분류
            </label>
            <input type="text"
                   name="category"
                   value="{% if book %}{{ book.category or '' }}{% endif %}"
                   maxlength="100"
                   class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                   placeholder="예: 소설, 에세이, 자기계발 등">
        </div>

        <!-- Description -->
        <div class="mb-6">
            <label class="block text-sm font-semibold text-gray-700 mb-2">
                책 소개
            </label>
            <textarea name="description"
                      rows="8"
                      class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                      placeholder="책에 대한 소개를 입력하세요">{% if book %}{{ book.description or '' }}{% endif %}</textarea>
        </div>

        <!-- Recommendation Reason -->
        <div class="mb-6">
            <label class="block text-sm font-semibold text-gray-700 mb-2">
                추천 이유
            </label>
            <textarea name="recommendation_reason"
                      rows="5"
                      class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                      placeholder="학생들에게 이 책을 추천하는 이유를 입력하세요">{% if book %}{{ book.recommendation_reason or '' }}{% endif %}</textarea>
        </div>

        <!-- Cover Image URL -->
        <div class="mb-6">
            <label class="block text-sm font-semibold text-gray-700 mb-2">
                표지 이미지 URL
            </label>
            <input type="url"
                   name="cover_image_url"
                   value="{% if book %}{{ book.cover_image_url or '' }}{% endif %}"
                   maxlength="500"
                   class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                   placeholder="https://example.com/cover.jpg">
            <p class="text-xs text-gray-500 mt-1">책 표지 이미지 URL을 입력하세요 (선택사항)</p>
        </div>

        <!-- 도서 뱃지 -->
        <div class="mb-6 bg-gray-50 rounded-lg p-5 border border-gray-200">
            <p class="text-sm font-semibold text-gray-700 mb-3">도서 뱃지</p>
            <div class="flex flex-col gap-4">
                <label class="flex items-start gap-3 cursor-pointer">
                    <input type="checkbox" name="is_curriculum" value="1"
                           {% if book and book.is_curriculum %}checked{% endif %}
                           class="mt-0.5 w-4 h-4 text-blue-600 rounded border-gray-300">
                    <div>
                        <span class="inline-block px-2.5 py-0.5 bg-blue-600 text-white text-xs font-bold rounded mr-2">수업도서</span>
                        <span class="text-sm text-gray-700">실제 커리큘럼에 반영되어 수업을 진행하는 도서입니다.</span>
                    </div>
                </label>
                <label class="flex items-start gap-3 cursor-pointer">
                    <input type="checkbox" name="is_recommended" value="1"
                           {% if book and book.is_recommended %}checked{% endif %}
                           class="mt-0.5 w-4 h-4 text-green-600 rounded border-gray-300">
                    <div>
                        <span class="inline-block px-2.5 py-0.5 bg-green-600 text-white text-xs font-bold rounded mr-2">추천도서</span>
                        <span class="text-sm text-gray-700">관리자가 별도로 추천하는 도서입니다.</span>
                    </div>
                </label>
            </div>
        </div>

        <!-- Buttons -->
        <div class="flex justify-end space-x-4 pt-6 border-t border-gray-200">
            <a href="{% if book %}{{ url_for('library.book_detail', book_id=book.book_id) }}{% else %}{{ url_for('library.books') }}{% endif %}"
               class="px-6 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition duration-200">
                취소
            </a>
            <button type="submit"
                    class="px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition duration-200">
                {% if book %}수정하기{% else %}등록하기{% endif %}
            </button>
        </div>
    </form>
</div>
{% endblock %}
