{% extends "base.html" %}

{% block title %}{% if post %}ëª…ì˜ˆì˜ ì „ë‹¹ ìˆ˜ì •{% else %}ëª…ì˜ˆì˜ ì „ë‹¹ ë“±ë¡{% endif %} - MOMOAI v4.0{% endblock %}

{% block content %}
<div class="max-w-5xl mx-auto">
    <!-- Header -->
    <div class="mb-8">
        <h2 class="text-3xl font-bold text-gray-800">
            {% if post %}ğŸ† ëª…ì˜ˆì˜ ì „ë‹¹ ìˆ˜ì •{% else %}ğŸ† ëª…ì˜ˆì˜ ì „ë‹¹ ë“±ë¡{% endif %}
        </h2>
        <p class="text-gray-600 mt-2">ìš°ìˆ˜í•œ í•™ìƒ ì‘í’ˆì„ ëª…ì˜ˆì˜ ì „ë‹¹ì— ë“±ë¡í•˜ì„¸ìš”</p>
    </div>

    <!-- Form -->
    <form method="POST" enctype="multipart/form-data" class="bg-white rounded-lg shadow p-8">
        <!-- Title -->
        <div class="mb-6">
            <label class="block text-sm font-semibold text-gray-700 mb-2">
                ì œëª© <span class="text-red-500">*</span>
            </label>
            <input type="text"
                   name="title"
                   value="{% if post %}{{ post.title }}{% endif %}"
                   required
                   maxlength="200"
                   class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                   placeholder="ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”">
        </div>

        <!-- Category -->
        <div class="mb-6">
            <label class="block text-sm font-semibold text-gray-700 mb-2">
                ë¶„ë¥˜ <span class="text-red-500">*</span>
            </label>
            <select name="category"
                    required
                    class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                <option value="excellent_answer" {% if post and post.category == 'excellent_answer' %}selected{% endif %}>ğŸ“ ìš°ìˆ˜ë‹µì•ˆ</option>
                <option value="mock_exam_award" {% if post and post.category == 'mock_exam_award' %}selected{% endif %}>ğŸ“Š ëª¨ì˜ê³ ì‚¬ ìˆ˜ìƒ</option>
                <option value="essay_award" {% if post and post.category == 'essay_award' %}selected{% endif %}>âœï¸ ì—ì„¸ì´ ìˆ˜ìƒ</option>
                <option value="other" {% if post and post.category == 'other' %}selected{% endif %}>ğŸ¯ ê¸°íƒ€</option>
            </select>
        </div>

        <!-- Student Selection -->
        <div class="mb-6">
            <label class="block text-sm font-semibold text-gray-700 mb-2">
                í•™ìƒ ì„ íƒ
            </label>
            <select name="student_id"
                    class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                <option value="">ì„ íƒ ì•ˆí•¨</option>
                {% for student in students %}
                <option value="{{ student.student_id }}" {% if post and post.student_id == student.student_id %}selected{% endif %}>
                    {{ student.name }} ({{ student.student_code }}) - {{ student.grade }}
                </option>
                {% endfor %}
            </select>
        </div>

        <!-- Award Name -->
        <div class="mb-6">
            <label class="block text-sm font-semibold text-gray-700 mb-2">
                ìˆ˜ìƒëª…
            </label>
            <input type="text"
                   name="award_name"
                   value="{% if post %}{{ post.award_name or '' }}{% endif %}"
                   maxlength="200"
                   class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                   placeholder="ì˜ˆ: 2024í•™ë…„ë„ ëª¨ì˜ê³ ì‚¬ 1ë“±, ìš°ìˆ˜ ì—ì„¸ì´ìƒ ë“±">
        </div>

        <!-- Grade -->
        <div class="mb-6">
            <label class="block text-sm font-semibold text-gray-700 mb-2">
                í•™ë…„
            </label>
            <input type="text"
                   name="grade"
                   value="{% if post %}{{ post.grade or '' }}{% endif %}"
                   maxlength="20"
                   class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                   placeholder="ì˜ˆ: ê³ 2, ì¤‘3 ë“±">
        </div>

        <!-- Content -->
        <div class="mb-6">
            <label class="block text-sm font-semibold text-gray-700 mb-2">
                ë‚´ìš© <span class="text-red-500">*</span>
            </label>
            <textarea name="content"
                      required
                      rows="15"
                      class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                      placeholder="ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”">{% if post %}{{ post.content }}{% endif %}</textarea>
        </div>

        <!-- File Upload -->
        <div class="mb-6">
            <label class="block text-sm font-semibold text-gray-700 mb-2">
                ì²¨ë¶€íŒŒì¼
            </label>
            {% if post and post.file_path %}
            <div class="mb-2 p-3 bg-gray-50 rounded border border-gray-200">
                <span class="text-sm text-gray-600">í˜„ì¬ íŒŒì¼: {{ post.file_path | basename }}</span>
                <label class="ml-4 text-sm text-blue-600 cursor-pointer">
                    <input type="checkbox" name="remove_file" value="1" class="mr-1">
                    íŒŒì¼ ì‚­ì œ
                </label>
            </div>
            {% endif %}
            <input type="file"
                   name="file"
                   accept=".pdf,.doc,.docx,.hwp,.txt"
                   class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent">
            <p class="text-xs text-gray-500 mt-1">PDF, DOC, DOCX, HWP, TXT íŒŒì¼ë§Œ ì—…ë¡œë“œ ê°€ëŠ¥ (ìµœëŒ€ 10MB)</p>
        </div>

        <!-- Published Status -->
        <div class="mb-6">
            <label class="flex items-center">
                <input type="checkbox"
                       name="is_published"
                       value="1"
                       {% if not post or post.is_published %}checked{% endif %}
                       class="w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500">
                <span class="ml-2 text-sm font-semibold text-gray-700">ê³µê°œ</span>
            </label>
            <p class="text-xs text-gray-500 mt-1">ì²´í¬ í•´ì œ ì‹œ í•™ìƒë“¤ì—ê²Œ ë³´ì´ì§€ ì•ŠìŠµë‹ˆë‹¤</p>
        </div>

        <!-- Buttons -->
        <div class="flex justify-end space-x-4 pt-6 border-t border-gray-200">
            <a href="{% if post %}{{ url_for('library.hall_of_fame_detail', post_id=post.post_id) }}{% else %}{{ url_for('library.hall_of_fame') }}{% endif %}"
               class="px-6 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition duration-200">
                ì·¨ì†Œ
            </a>
            <button type="submit"
                    class="px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition duration-200">
                {% if post %}ìˆ˜ì •í•˜ê¸°{% else %}ë“±ë¡í•˜ê¸°{% endif %}
            </button>
        </div>
    </form>
</div>
{% endblock %}
