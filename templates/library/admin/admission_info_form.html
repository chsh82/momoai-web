{% extends "base.html" %}

{% block title %}{% if post %}입시정보 수정{% else %}입시정보 등록{% endif %} - MOMOAI v4.0{% endblock %}

{% block content %}
<div class="max-w-5xl mx-auto">
    <!-- Header -->
    <div class="mb-8">
        <h2 class="text-3xl font-bold text-gray-800">
            {% if post %}📋 입시정보 수정{% else %}📋 입시정보 등록{% endif %}
        </h2>
        <p class="text-gray-600 mt-2">중요한 입시 정보를 등록하세요</p>
    </div>

    <!-- Form -->
    <form method="POST" enctype="multipart/form-data" class="bg-white rounded-lg shadow p-8">
        <!-- Title -->
        <div class="mb-6">
            <label class="block text-sm font-semibold text-gray-700 mb-2">
                제목 <span class="text-red-500">*</span>
            </label>
            <input type="text"
                   name="title"
                   value="{% if post %}{{ post.title }}{% endif %}"
                   required
                   maxlength="200"
                   class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                   placeholder="제목을 입력하세요">
        </div>

        <!-- Category -->
        <div class="mb-6">
            <label class="block text-sm font-semibold text-gray-700 mb-2">
                분류 <span class="text-red-500">*</span>
            </label>
            <select name="category"
                    required
                    class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                <option value="">선택하세요</option>
                <option value="university" {% if post and post.category == 'university' %}selected{% endif %}>🎓 대학입시</option>
                <option value="high_school" {% if post and post.category == 'high_school' %}selected{% endif %}>🏫 고등학교</option>
                <option value="policy" {% if post and post.category == 'policy' %}selected{% endif %}>📜 정책</option>
                <option value="schedule" {% if post and post.category == 'schedule' %}selected{% endif %}>📅 일정</option>
                <option value="tips" {% if post and post.category == 'tips' %}selected{% endif %}>💡 입시 팁</option>
                <option value="other" {% if post and post.category == 'other' %}selected{% endif %}>🎯 기타</option>
            </select>
        </div>

        <!-- Target Grades -->
        <div class="mb-6">
            <label class="block text-sm font-semibold text-gray-700 mb-2">
                대상 학년
            </label>
            <input type="text"
                   name="target_grades"
                   value="{% if post %}{{ post.target_grades or '' }}{% endif %}"
                   maxlength="100"
                   class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                   placeholder="예: 고1, 고2, 고3 또는 전체">
            <p class="text-xs text-gray-500 mt-1">비워두면 전체 학년에 표시됩니다</p>
        </div>

        <!-- Content -->
        <div class="mb-6">
            <label class="block text-sm font-semibold text-gray-700 mb-2">
                내용 <span class="text-red-500">*</span>
            </label>
            <textarea name="content"
                      required
                      rows="15"
                      class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                      placeholder="내용을 입력하세요">{% if post %}{{ post.content }}{% endif %}</textarea>
        </div>

        <!-- External URL -->
        <div class="mb-6">
            <label class="block text-sm font-semibold text-gray-700 mb-2">
                관련 링크 (URL)
            </label>
            <input type="url"
                   name="external_url"
                   value="{% if post %}{{ post.external_url or '' }}{% endif %}"
                   maxlength="500"
                   class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                   placeholder="https://example.com">
        </div>

        <!-- File Upload -->
        <div class="mb-6">
            <label class="block text-sm font-semibold text-gray-700 mb-2">
                첨부파일
            </label>
            {% if post and post.file_path %}
            <div class="mb-2 p-3 bg-gray-50 rounded border border-gray-200">
                <span class="text-sm text-gray-600">현재 파일: {{ post.file_path | basename }}</span>
                <label class="ml-4 text-sm text-blue-600 cursor-pointer">
                    <input type="checkbox" name="remove_file" value="1" class="mr-1">
                    파일 삭제
                </label>
            </div>
            {% endif %}
            <input type="file"
                   name="file"
                   accept=".pdf,.doc,.docx,.hwp,.txt,.xls,.xlsx"
                   class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent">
            <p class="text-xs text-gray-500 mt-1">PDF, DOC, DOCX, HWP, TXT, XLS, XLSX 파일만 업로드 가능 (최대 10MB)</p>
        </div>

        <!-- Date Range -->
        <div class="grid grid-cols-2 gap-4 mb-6">
            <div>
                <label class="block text-sm font-semibold text-gray-700 mb-2">
                    게시 시작일
                </label>
                <input type="date"
                       name="publish_date"
                       value="{% if post and post.publish_date %}{{ post.publish_date.strftime('%Y-%m-%d') }}{% endif %}"
                       class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                <p class="text-xs text-gray-500 mt-1">비워두면 즉시 게시됩니다</p>
            </div>
            <div>
                <label class="block text-sm font-semibold text-gray-700 mb-2">
                    게시 종료일
                </label>
                <input type="date"
                       name="expire_date"
                       value="{% if post and post.expire_date %}{{ post.expire_date.strftime('%Y-%m-%d') }}{% endif %}"
                       class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                <p class="text-xs text-gray-500 mt-1">비워두면 무제한 게시됩니다</p>
            </div>
        </div>

        <!-- Important Flag -->
        <div class="mb-6">
            <label class="flex items-center">
                <input type="checkbox"
                       name="is_important"
                       value="1"
                       {% if post and post.is_important %}checked{% endif %}
                       class="w-4 h-4 text-red-600 border-gray-300 rounded focus:ring-red-500">
                <span class="ml-2 text-sm font-semibold text-gray-700">중요 공지 (상단 고정)</span>
            </label>
            <p class="text-xs text-gray-500 mt-1">체크하면 목록 상단에 강조 표시됩니다</p>
        </div>

        <!-- Buttons -->
        <div class="flex justify-end space-x-4 pt-6 border-t border-gray-200">
            <a href="{% if post %}{{ url_for('library.admission_info_detail', post_id=post.post_id) }}{% else %}{{ url_for('library.admission_info') }}{% endif %}"
               class="px-6 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition duration-200">
                취소
            </a>
            <button type="submit"
                    class="px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition duration-200">
                {% if post %}수정하기{% else %}등록하기{% endif %}
            </button>
        </div>
    </form>
</div>
{% endblock %}
