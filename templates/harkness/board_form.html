{% extends "base.html" %}

{% block title %}게시판 생성 - 하크니스{% endblock %}

{% block content %}
<div class="max-w-3xl mx-auto">
    <div class="mb-6">
        <a href="{{ url_for('harkness.index') }}"
           class="text-blue-600 hover:text-blue-800 font-medium mb-2 inline-block">
            ← 목록으로
        </a>
        <h2 class="text-3xl font-bold text-gray-800">게시판 생성</h2>
    </div>

    <form method="POST" class="bg-white rounded-lg shadow p-8">
        <!-- 게시판 유형 -->
        <div class="mb-6">
            <label class="block text-sm font-medium text-gray-700 mb-2">
                게시판 유형 <span class="text-red-500">*</span>
            </label>
            <select name="board_type"
                    id="boardType"
                    onchange="toggleCourseSelect()"
                    class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                    required>
                {% if current_user.is_admin %}
                <option value="harkness_all">하크니스 전체 (모든 하크니스 학생)</option>
                {% endif %}
                <option value="course" {% if not current_user.is_admin %}selected{% endif %}>수업별 게시판</option>
            </select>
        </div>

        <!-- 수업 선택 -->
        <div id="courseSelectDiv" class="mb-6">
            <label class="block text-sm font-medium text-gray-700 mb-2">
                수업 선택 <span class="text-red-500">*</span>
            </label>
            <select name="course_id"
                    id="courseSelect"
                    class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                <option value="">-- 수업 선택 --</option>
                {% for course in harkness_courses %}
                <option value="{{ course.course_id }}">{{ course.course_name }}</option>
                {% endfor %}
            </select>
        </div>

        <!-- 제목 -->
        <div class="mb-6">
            <label class="block text-sm font-medium text-gray-700 mb-2">
                제목 <span class="text-red-500">*</span>
            </label>
            <input type="text"
                   name="title"
                   class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                   placeholder="예: 김선생님 하크니스반"
                   required>
        </div>

        <!-- 설명 -->
        <div class="mb-6">
            <label class="block text-sm font-medium text-gray-700 mb-2">
                설명 (선택)
            </label>
            <textarea name="description"
                      rows="3"
                      class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                      placeholder="게시판에 대한 간단한 설명"></textarea>
        </div>

        <!-- 버튼 -->
        <div class="flex gap-3">
            <button type="submit"
                    class="flex-1 bg-blue-600 hover:bg-blue-700 text-white font-medium py-3 rounded-lg transition duration-200">
                생성하기
            </button>
            <a href="{{ url_for('harkness.index') }}"
               class="flex-1 text-center bg-gray-400 hover:bg-gray-500 text-white font-medium py-3 rounded-lg transition duration-200">
                취소
            </a>
        </div>
    </form>
</div>

<script>
function toggleCourseSelect() {
    const boardType = document.getElementById('boardType').value;
    const courseSelectDiv = document.getElementById('courseSelectDiv');
    const courseSelect = document.getElementById('courseSelect');

    if (boardType === 'course') {
        courseSelectDiv.style.display = 'block';
        courseSelect.required = true;
    } else {
        courseSelectDiv.style.display = 'none';
        courseSelect.required = false;
    }
}

// 페이지 로드 시 초기화
window.addEventListener('DOMContentLoaded', toggleCourseSelect);
</script>
{% endblock %}
