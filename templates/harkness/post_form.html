{% extends "base.html" %}

{% block title %}{% if post %}ê¸€ ìˆ˜ì •{% else %}ê¸€ ì‘ì„±{% endif %} - í•˜í¬ë‹ˆìŠ¤{% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto">
    <div class="mb-6">
        <a href="{% if post %}{{ url_for('harkness.post_detail', board_id=board.board_id, post_id=post.post_id) }}{% else %}{{ url_for('harkness.board_detail', board_id=board.board_id) }}{% endif %}"
           class="text-blue-600 hover:text-blue-800 font-medium mb-2 inline-block">
            â† ë’¤ë¡œê°€ê¸°
        </a>
        <h2 class="text-3xl font-bold text-gray-800">
            {% if post %}âœï¸ ê¸€ ìˆ˜ì •{% else %}âœï¸ ê¸€ ì‘ì„±{% endif %}
        </h2>
        <p class="text-gray-600 mt-1">{{ board.title }}</p>
    </div>

    <!-- Flash Messages -->
    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            {% for category, message in messages %}
            <div class="mb-6 p-4 rounded-lg {% if category == 'error' %}bg-red-100 text-red-700 border border-red-300{% elif category == 'success' %}bg-green-100 text-green-700 border border-green-300{% else %}bg-blue-100 text-blue-700 border border-blue-300{% endif %}">
                {{ message }}
            </div>
            {% endfor %}
        {% endif %}
    {% endwith %}

    {% if board.post_format != 'general' %}
    <!-- í•˜í¬ë‹ˆìŠ¤ ì–‘ì‹ ì•ˆë‚´ ë°°ë„ˆ -->
    <div class="bg-purple-50 border border-purple-200 rounded-lg p-4 mb-6">
        <div class="flex items-start gap-3">
            <span class="text-2xl">ğŸ’¡</span>
            <div class="text-sm text-purple-800">
                <p class="font-semibold mb-1">í•˜í¬ë‹ˆìŠ¤ ì§ˆë¬¸ ì‘ì„± ì•ˆë‚´</p>
                <ul class="list-disc list-inside space-y-1">
                    <li>ìˆ˜ì—… í† ë¡ ì„ ìœ„í•œ <strong>3ê°œì˜ ì§ˆë¬¸</strong>ì„ ì‘ì„±í•´ì£¼ì„¸ìš”.</li>
                    <li>ê° ì§ˆë¬¸ ì•„ë˜ì— <strong>ì˜ˆìƒ ë‹µë³€ ë° ì§ˆë¬¸ì˜ ì˜ë„</strong>ë¥¼ í•¨ê»˜ ì‘ì„±í•˜ë©´ ì¢‹ìŠµë‹ˆë‹¤.</li>
                    <li>ì¢‹ì€ ì§ˆë¬¸ì€ ë‹¨ìˆœí•œ ì‚¬ì‹¤ í™•ì¸ë³´ë‹¤ <strong>ìƒê°ì„ ìœ ë„í•˜ëŠ” ì—´ë¦° ì§ˆë¬¸</strong>ì…ë‹ˆë‹¤.</li>
                </ul>
            </div>
        </div>
    </div>
    {% endif %}

    <form method="POST" class="space-y-6">
        <!-- ì œëª© -->
        <div class="bg-white rounded-lg shadow p-6">
            <label class="block text-sm font-medium text-gray-700 mb-2">
                ì œëª© <span class="text-red-500">*</span>
            </label>
            <input type="text"
                   name="title"
                   value="{% if post %}{{ post.title }}{% endif %}"
                   class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500"
                   placeholder="ê²Œì‹œê¸€ ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”"
                   required>

            <!-- ê³µì§€ì‚¬í•­ ì—¬ë¶€ -->
            {% if can_write_notice %}
            <div class="mt-4">
                <label class="flex items-center gap-2 cursor-pointer">
                    <input type="checkbox"
                           name="is_notice"
                           {% if post and post.is_notice %}checked{% endif %}
                           class="w-5 h-5 text-purple-600 rounded focus:ring-2 focus:ring-purple-500">
                    <span class="text-sm font-medium text-gray-700">ê³µì§€ì‚¬í•­ìœ¼ë¡œ ë“±ë¡</span>
                </label>
            </div>
            {% endif %}
        </div>

        {% if board.post_format == 'general' %}
        <!-- ì¼ë°˜ ì–‘ì‹: ë‚´ìš©ë§Œ -->
        <div class="bg-white rounded-lg shadow p-6">
            <label class="block text-sm font-medium text-gray-700 mb-2">
                ë‚´ìš© <span class="text-red-500">*</span>
            </label>
            <textarea name="content"
                      rows="10"
                      class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                      placeholder="ë‚´ìš©ì„ ììœ ë¡­ê²Œ ì‘ì„±í•˜ì„¸ìš”..."
                      required>{% if post and post.content %}{{ post.content }}{% endif %}</textarea>
        </div>

        {% else %}
        <!-- í•˜í¬ë‹ˆìŠ¤ ì–‘ì‹: 3ê°œ ì§ˆë¬¸ -->

        <!-- ì§ˆë¬¸ 1 -->
        <div class="bg-white rounded-lg shadow p-6 border-l-4 border-blue-500">
            <div class="flex items-center gap-2 mb-4">
                <span class="bg-blue-500 text-white text-sm font-bold px-3 py-1 rounded-full">ì§ˆë¬¸ 1</span>
                <span class="text-sm text-red-500 font-medium">* í•„ìˆ˜</span>
            </div>
            <div class="mb-4">
                <label class="block text-sm font-medium text-gray-700 mb-2">ì§ˆë¬¸ ë‚´ìš©</label>
                <textarea name="question1"
                          rows="3"
                          class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                          placeholder="ì²« ë²ˆì§¸ ì§ˆë¬¸ì„ ì…ë ¥í•˜ì„¸ìš”..."
                          required>{% if post and post.question1 %}{{ post.question1 }}{% endif %}</textarea>
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">
                    ì˜ˆìƒ ë‹µë³€ ë° ì§ˆë¬¸ì˜ ì˜ë„ <span class="text-gray-400 font-normal">(ì„ íƒ)</span>
                </label>
                <textarea name="question1_intent"
                          rows="3"
                          class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 bg-blue-50"
                          placeholder="ì´ ì§ˆë¬¸ì„ í†µí•´ ë¬´ì—‡ì„ ë…¼ì˜í•˜ê³  ì‹¶ì€ì§€, ì˜ˆìƒë˜ëŠ” ë‹µë³€ ë°©í–¥ ë“±ì„ ì‘ì„±í•˜ì„¸ìš”...">{% if post and post.question1_intent %}{{ post.question1_intent }}{% endif %}</textarea>
            </div>
        </div>

        <!-- ì§ˆë¬¸ 2 -->
        <div class="bg-white rounded-lg shadow p-6 border-l-4 border-green-500">
            <div class="flex items-center gap-2 mb-4">
                <span class="bg-green-500 text-white text-sm font-bold px-3 py-1 rounded-full">ì§ˆë¬¸ 2</span>
                <span class="text-sm text-red-500 font-medium">* í•„ìˆ˜</span>
            </div>
            <div class="mb-4">
                <label class="block text-sm font-medium text-gray-700 mb-2">ì§ˆë¬¸ ë‚´ìš©</label>
                <textarea name="question2"
                          rows="3"
                          class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"
                          placeholder="ë‘ ë²ˆì§¸ ì§ˆë¬¸ì„ ì…ë ¥í•˜ì„¸ìš”..."
                          required>{% if post and post.question2 %}{{ post.question2 }}{% endif %}</textarea>
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">
                    ì˜ˆìƒ ë‹µë³€ ë° ì§ˆë¬¸ì˜ ì˜ë„ <span class="text-gray-400 font-normal">(ì„ íƒ)</span>
                </label>
                <textarea name="question2_intent"
                          rows="3"
                          class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 bg-green-50"
                          placeholder="ì´ ì§ˆë¬¸ì„ í†µí•´ ë¬´ì—‡ì„ ë…¼ì˜í•˜ê³  ì‹¶ì€ì§€, ì˜ˆìƒë˜ëŠ” ë‹µë³€ ë°©í–¥ ë“±ì„ ì‘ì„±í•˜ì„¸ìš”...">{% if post and post.question2_intent %}{{ post.question2_intent }}{% endif %}</textarea>
            </div>
        </div>

        <!-- ì§ˆë¬¸ 3 -->
        <div class="bg-white rounded-lg shadow p-6 border-l-4 border-orange-500">
            <div class="flex items-center gap-2 mb-4">
                <span class="bg-orange-500 text-white text-sm font-bold px-3 py-1 rounded-full">ì§ˆë¬¸ 3</span>
                <span class="text-sm text-red-500 font-medium">* í•„ìˆ˜</span>
            </div>
            <div class="mb-4">
                <label class="block text-sm font-medium text-gray-700 mb-2">ì§ˆë¬¸ ë‚´ìš©</label>
                <textarea name="question3"
                          rows="3"
                          class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"
                          placeholder="ì„¸ ë²ˆì§¸ ì§ˆë¬¸ì„ ì…ë ¥í•˜ì„¸ìš”..."
                          required>{% if post and post.question3 %}{{ post.question3 }}{% endif %}</textarea>
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">
                    ì˜ˆìƒ ë‹µë³€ ë° ì§ˆë¬¸ì˜ ì˜ë„ <span class="text-gray-400 font-normal">(ì„ íƒ)</span>
                </label>
                <textarea name="question3_intent"
                          rows="3"
                          class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 bg-orange-50"
                          placeholder="ì´ ì§ˆë¬¸ì„ í†µí•´ ë¬´ì—‡ì„ ë…¼ì˜í•˜ê³  ì‹¶ì€ì§€, ì˜ˆìƒë˜ëŠ” ë‹µë³€ ë°©í–¥ ë“±ì„ ì‘ì„±í•˜ì„¸ìš”...">{% if post and post.question3_intent %}{{ post.question3_intent }}{% endif %}</textarea>
            </div>
        </div>

        <!-- ì¶”ê°€ ë‚´ìš© (ì„ íƒ) -->
        <div class="bg-white rounded-lg shadow p-6">
            <label class="block text-sm font-medium text-gray-700 mb-2">
                ì¶”ê°€ ë‚´ìš© <span class="text-gray-400 font-normal">(ì„ íƒ)</span>
            </label>
            <textarea name="content"
                      rows="5"
                      class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500"
                      placeholder="ìœ„ ì§ˆë¬¸ ì™¸ì— ê³µìœ í•˜ê³  ì‹¶ì€ ë‚´ìš©ì´ ìˆìœ¼ë©´ ììœ ë¡­ê²Œ ì‘ì„±í•˜ì„¸ìš”...">{% if post and post.content %}{{ post.content }}{% endif %}</textarea>
        </div>
        {% endif %}

        <!-- ë²„íŠ¼ -->
        <div class="flex gap-3">
            <button type="submit"
                    class="flex-1 bg-purple-600 hover:bg-purple-700 text-white font-medium py-3 rounded-lg transition duration-200">
                {% if post %}ìˆ˜ì •í•˜ê¸°{% else %}ë“±ë¡í•˜ê¸°{% endif %}
            </button>
            <a href="{% if post %}{{ url_for('harkness.post_detail', board_id=board.board_id, post_id=post.post_id) }}{% else %}{{ url_for('harkness.board_detail', board_id=board.board_id) }}{% endif %}"
               class="flex-1 text-center bg-gray-400 hover:bg-gray-500 text-white font-medium py-3 rounded-lg transition duration-200">
                ì·¨ì†Œ
            </a>
        </div>
    </form>
</div>
{% endblock %}
