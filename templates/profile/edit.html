{% extends "base.html" %}

{% block title %}í”„ë¡œí•„ ìˆ˜ì • - MOMOAI v4.0{% endblock %}

{% block content %}
<div class="max-w-2xl mx-auto">
    <!-- Header -->
    <div class="mb-6">
        <a href="{{ url_for('profile.index') }}" class="text-blue-600 hover:text-blue-800 font-medium mb-2 inline-block">
            â† í”„ë¡œí•„ë¡œ ëŒì•„ê°€ê¸°
        </a>
        <h2 class="text-3xl font-bold text-gray-800">í”„ë¡œí•„ ìˆ˜ì •</h2>
        <p class="text-gray-600 mt-1">ê¸°ë³¸ ì •ë³´ë¥¼ ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤</p>
    </div>

    <!-- Flash messages -->
    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            {% for category, message in messages %}
            <div class="mb-4 p-4 rounded-lg {% if category == 'error' %}bg-red-100 text-red-700{% elif category == 'success' %}bg-green-100 text-green-700{% else %}bg-blue-100 text-blue-700{% endif %}">
                {{ message }}
            </div>
            {% endfor %}
        {% endif %}
    {% endwith %}

    <!-- Form -->
    <div class="bg-white rounded-lg shadow-lg p-8">
        <form method="POST" action="{{ url_for('profile.edit') }}" enctype="multipart/form-data">
            {{ form.hidden_tag() }}

            <div class="space-y-6">
                <!-- ì´ë¦„ -->
                <div>
                    {{ form.name.label(class="block text-sm font-medium text-gray-700 mb-2") }}
                    {{ form.name(class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" + (" border-red-500" if form.name.errors else "")) }}
                    {% if form.name.errors %}
                        {% for error in form.name.errors %}
                        <p class="text-red-500 text-sm mt-1">{{ error }}</p>
                        {% endfor %}
                    {% endif %}
                </div>

                <!-- ì´ë©”ì¼ -->
                <div>
                    {{ form.email.label(class="block text-sm font-medium text-gray-700 mb-2") }}
                    {{ form.email(class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" + (" border-red-500" if form.email.errors else ""), type="email") }}
                    {% if form.email.errors %}
                        {% for error in form.email.errors %}
                        <p class="text-red-500 text-sm mt-1">{{ error }}</p>
                        {% endfor %}
                    {% endif %}
                </div>

                <!-- ì „í™”ë²ˆí˜¸ -->
                <div>
                    {{ form.phone.label(class="block text-sm font-medium text-gray-700 mb-2") }}
                    {{ form.phone(class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500", placeholder="010-1234-5678") }}
                    {% if form.phone.errors %}
                        {% for error in form.phone.errors %}
                        <p class="text-red-500 text-sm mt-1">{{ error }}</p>
                        {% endfor %}
                    {% endif %}
                </div>

                {% if current_user.role == 'student' %}
                <!-- í•™ìƒ ì „ìš© í•„ë“œ -->
                <div class="border-t border-gray-200 pt-6">
                    <h3 class="text-lg font-medium text-gray-800 mb-4">ğŸ“š í•™ìƒ ì •ë³´</h3>

                    <!-- í•™ë…„ -->
                    <div class="mb-4">
                        {{ form.grade.label(class="block text-sm font-medium text-gray-700 mb-2") }}
                        {{ form.grade(class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500") }}
                        {% if form.grade.errors %}
                            {% for error in form.grade.errors %}
                            <p class="text-red-500 text-sm mt-1">{{ error }}</p>
                            {% endfor %}
                        {% endif %}
                    </div>

                    <!-- í•™êµ -->
                    <div class="mb-4">
                        {{ form.school.label(class="block text-sm font-medium text-gray-700 mb-2") }}
                        {{ form.school(class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",
                                       list="schoolList",
                                       placeholder="í•™êµëª…ì„ ì…ë ¥í•˜ê±°ë‚˜ ì„ íƒí•˜ì„¸ìš”",
                                       autocomplete="off") }}
                        <datalist id="schoolList">
                            <option value="ì„œìš¸ì´ˆë“±í•™êµ">
                            <option value="ì„œìš¸ì¤‘í•™êµ">
                            <option value="ì„œìš¸ê³ ë“±í•™êµ">
                            <option value="ê°•ë‚¨ì´ˆë“±í•™êµ">
                            <option value="ê°•ë‚¨ì¤‘í•™êµ">
                            <option value="ê°•ë‚¨ê³ ë“±í•™êµ">
                            <option value="ëª©ë™ì´ˆë“±í•™êµ">
                            <option value="ëª©ë™ì¤‘í•™êµ">
                            <option value="ëª©ë™ê³ ë“±í•™êµ">
                            <option value="ë¶„ë‹¹ì´ˆë“±í•™êµ">
                            <option value="ë¶„ë‹¹ì¤‘í•™êµ">
                            <option value="ë¶„ë‹¹ê³ ë“±í•™êµ">
                            <option value="ì¼ì‚°ì´ˆë“±í•™êµ">
                            <option value="ì¼ì‚°ì¤‘í•™êµ">
                            <option value="ì¼ì‚°ê³ ë“±í•™êµ">
                            <option value="ê´‘êµì´ˆë“±í•™êµ">
                            <option value="ê´‘êµì¤‘í•™êµ">
                            <option value="ê´‘êµê³ ë“±í•™êµ">
                            <option value="í‰ì´Œì´ˆë“±í•™êµ">
                            <option value="í‰ì´Œì¤‘í•™êµ">
                            <option value="í‰ì´Œê³ ë“±í•™êµ">
                        </datalist>
                        <p class="text-xs text-gray-500 mt-1">ëª©ë¡ì— ì—†ìœ¼ë©´ ì§ì ‘ ì…ë ¥í•˜ì„¸ìš”</p>
                        {% if form.school.errors %}
                            {% for error in form.school.errors %}
                            <p class="text-red-500 text-sm mt-1">{{ error }}</p>
                            {% endfor %}
                        {% endif %}
                    </div>

                    <!-- ìƒë…„ì›”ì¼ -->
                    <div class="mb-4">
                        {{ form.birth_date.label(class="block text-sm font-medium text-gray-700 mb-2") }}
                        {{ form.birth_date(class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500") }}
                        <p class="text-xs text-gray-500 mt-1">ì˜ˆ: 2010-03-15</p>
                        {% if form.birth_date.errors %}
                            {% for error in form.birth_date.errors %}
                            <p class="text-red-500 text-sm mt-1">{{ error }}</p>
                            {% endfor %}
                        {% endif %}
                    </div>
                </div>
                {% endif %}

                <!-- í”„ë¡œí•„ ì´ë¯¸ì§€ -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">í”„ë¡œí•„ ì´ë¯¸ì§€</label>
                    {% if current_user.profile_image_path %}
                    <div class="mb-4">
                        <img src="{{ url_for('profile.profile_image', user_id=current_user.user_id) }}"
                             alt="í”„ë¡œí•„ ì´ë¯¸ì§€"
                             class="w-32 h-32 rounded-full object-cover border-4 border-gray-200">
                    </div>
                    {% endif %}
                    <input type="file"
                           name="profile_image"
                           accept="image/*"
                           class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-medium file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100">
                    <p class="mt-2 text-sm text-gray-500">
                        JPG, PNG, GIF í˜•ì‹ (ìµœëŒ€ 5MB)
                    </p>
                </div>

                <!-- ì •ë³´ ë°•ìŠ¤ -->
                <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                    <div class="flex items-start">
                        <div class="text-blue-600 text-xl mr-3">â„¹ï¸</div>
                        <div class="text-sm text-blue-800">
                            <p class="font-medium mb-1">í”„ë¡œí•„ ìˆ˜ì • ì•ˆë‚´</p>
                            <ul class="list-disc list-inside space-y-1 text-blue-700">
                                <li>ì´ë©”ì¼ ì£¼ì†ŒëŠ” ë¡œê·¸ì¸ ì‹œ ì‚¬ìš©ë©ë‹ˆë‹¤</li>
                                <li>ë‹¤ë¥¸ ì‚¬ìš©ìê°€ ì‚¬ìš© ì¤‘ì¸ ì´ë©”ì¼ì€ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤</li>
                                <li>ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ì€ ë³„ë„ ë©”ë‰´ë¥¼ ì´ìš©í•˜ì„¸ìš”</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- ë²„íŠ¼ -->
                <div class="flex gap-3 pt-4">
                    {{ form.submit(class="flex-1 bg-blue-600 hover:bg-blue-700 text-white font-medium py-3 rounded-lg transition duration-200") }}
                    <a href="{{ url_for('profile.index') }}"
                       class="flex-1 text-center bg-gray-400 hover:bg-gray-500 text-white font-medium py-3 rounded-lg transition duration-200">
                        ì·¨ì†Œ
                    </a>
                </div>
            </div>
        </form>
    </div>
</div>
{% endblock %}
