{% extends "base.html" %}

{% block title %}ìƒë‹´ ê¸°ë¡ - {{ consultation.title }} - MOMOAI v4.0{% endblock %}

{% block content %}
<div class="max-w-6xl mx-auto">
    <!-- Header -->
    <div class="mb-6">
        <a href="{{ url_for('admin.consultations') }}"
           class="text-blue-600 hover:text-blue-800 font-medium mb-2 inline-block">
            â† ëª©ë¡ìœ¼ë¡œ
        </a>
        <h2 class="text-3xl font-bold text-gray-800">ìƒë‹´ ê¸°ë¡</h2>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
        <!-- ì™¼ìª½: ìƒë‹´ ë‚´ìš© -->
        <div class="lg:col-span-2 space-y-6">
            <!-- ê¸°ë³¸ ì •ë³´ ì¹´ë“œ -->
            <div class="bg-white rounded-lg shadow-lg p-6">
                <div class="flex items-start justify-between mb-4">
                    <div class="flex-1">
                        <div class="flex items-center gap-3 mb-3">
                            <span class="bg-blue-100 text-blue-800 text-sm font-semibold px-3 py-1 rounded">
                                {{ consultation.major_category }}
                            </span>
                            {% if consultation.share_with_parents %}
                            <span class="bg-green-100 text-green-800 text-sm font-semibold px-3 py-1 rounded">
                                âœ“ í•™ë¶€ëª¨ ê³µìœ 
                            </span>
                            {% endif %}
                        </div>
                        <h3 class="text-2xl font-bold text-gray-900">{{ consultation.title }}</h3>
                    </div>
                </div>

                <div class="grid grid-cols-2 gap-4 text-sm border-t border-gray-200 pt-4 mt-4">
                    <div>
                        <span class="text-gray-500">í•™ìƒ:</span>
                        <span class="font-semibold text-gray-800">{{ consultation.student.name }} ({{ consultation.student.grade }})</span>
                    </div>
                    <div>
                        <span class="text-gray-500">ìƒë‹´ì:</span>
                        <span class="font-semibold text-gray-800">{{ consultation.counselor.name }}</span>
                    </div>
                    <div>
                        <span class="text-gray-500">ìƒë‹´ì¼:</span>
                        <span class="font-semibold text-gray-800">{{ consultation.consultation_date.strftime('%Yë…„ %mì›” %dì¼') }}</span>
                    </div>
                    <div>
                        <span class="text-gray-500">ì‘ì„±ì¼:</span>
                        <span class="font-semibold text-gray-800">{{ consultation.created_at.strftime('%Y-%m-%d %H:%M') }}</span>
                    </div>
                </div>
            </div>

            <!-- ìƒë‹´ ë‚´ìš© ì¹´ë“œ -->
            <div class="bg-white rounded-lg shadow-lg p-6">
                <h4 class="text-lg font-bold text-gray-800 mb-4">ìƒë‹´ ë‚´ìš©</h4>
                <div class="prose max-w-none whitespace-pre-wrap text-gray-700">
                    {{ consultation.content }}
                </div>
            </div>

            <!-- MBTI ê¸°ë°˜ ì¶”ì²œ (ìˆëŠ” ê²½ìš°) -->
            {% if consultation.teaching_recommendations %}
            <div class="bg-purple-50 border-2 border-purple-200 rounded-lg shadow-lg p-6">
                <h4 class="text-lg font-bold text-purple-900 mb-4">ğŸ¯ MBTI ê¸°ë°˜ ìˆ˜ì—… ì¶”ì²œ</h4>
                <div class="prose max-w-none whitespace-pre-wrap text-gray-700 text-sm">
                    {{ consultation.teaching_recommendations }}
                </div>
            </div>
            {% endif %}
        </div>

        <!-- ì˜¤ë¥¸ìª½: ìš”ì•½ ì •ë³´ -->
        <div class="lg:col-span-1">
            <!-- MBTI ì •ë³´ ì¹´ë“œ -->
            {% if consultation.student_mbti_type %}
            <div class="bg-purple-50 border-2 border-purple-200 rounded-lg p-6 mb-6">
                <h4 class="text-lg font-bold text-purple-900 mb-4">ğŸ¯ MBTI ì •ë³´</h4>

                <div class="bg-white rounded-lg p-4 mb-4">
                    <div class="text-center">
                        <div class="text-xl font-bold text-purple-900">{{ consultation.recommended_teaching_style }}</div>
                        <div class="text-sm text-purple-700 mt-1">{{ consultation.student_mbti_type }}</div>
                    </div>
                </div>

                <div class="text-xs text-purple-700">
                    ì´ í•™ìƒì˜ ë…ì„œ ë…¼ìˆ  MBTI ê²€ì‚¬ ê²°ê³¼ë¥¼ ë°”íƒ•ìœ¼ë¡œ ë§ì¶¤í˜• ìˆ˜ì—… ì¶”ì²œì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.
                </div>
            </div>
            {% else %}
            <div class="bg-gray-50 border border-gray-200 rounded-lg p-6 mb-6">
                <h4 class="text-lg font-bold text-gray-700 mb-2">MBTI ì •ë³´ ì—†ìŒ</h4>
                <p class="text-sm text-gray-600">
                    ì´ ìƒë‹´ ê¸°ë¡ì—ëŠ” MBTI ê¸°ë°˜ ì¶”ì²œì´ í¬í•¨ë˜ì–´ ìˆì§€ ì•ŠìŠµë‹ˆë‹¤.
                </p>
            </div>
            {% endif %}

            <!-- ê³µìœ  ìƒíƒœ ì¹´ë“œ -->
            <div class="bg-white rounded-lg shadow p-6">
                <h4 class="text-lg font-bold text-gray-800 mb-4">ê³µìœ  ì„¤ì •</h4>

                {% if consultation.share_with_parents %}
                <div class="flex items-center gap-3 mb-3">
                    <div class="w-10 h-10 bg-green-100 rounded-full flex items-center justify-center">
                        <svg class="w-6 h-6 text-green-600" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/>
                        </svg>
                    </div>
                    <div>
                        <div class="font-semibold text-green-800">í•™ë¶€ëª¨ ê³µìœ ë¨</div>
                        {% if consultation.parent_shared_at %}
                        <div class="text-xs text-gray-600">{{ consultation.parent_shared_at.strftime('%Y-%m-%d %H:%M') }}</div>
                        {% endif %}
                    </div>
                </div>
                <p class="text-sm text-gray-600">
                    í•™ë¶€ëª¨ê°€ ìë…€ì˜ ìƒë‹´ ê¸°ë¡ê³¼ MBTI ì¶”ì²œì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                </p>
                {% else %}
                <div class="flex items-center gap-3 mb-3">
                    <div class="w-10 h-10 bg-gray-100 rounded-full flex items-center justify-center">
                        <svg class="w-6 h-6 text-gray-600" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z" clip-rule="evenodd"/>
                        </svg>
                    </div>
                    <div>
                        <div class="font-semibold text-gray-800">ë¹„ê³µê°œ</div>
                        <div class="text-xs text-gray-600">ê°•ì‚¬/ê´€ë¦¬ìë§Œ ì—´ëŒ</div>
                    </div>
                </div>
                <p class="text-sm text-gray-600">
                    í•™ë¶€ëª¨ì—ê²Œ ê³µìœ ë˜ì§€ ì•Šì€ ìƒë‹´ ê¸°ë¡ì…ë‹ˆë‹¤.
                </p>
                {% endif %}
            </div>
        </div>
    </div>
</div>
{% endblock %}
