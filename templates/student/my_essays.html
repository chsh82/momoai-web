{% extends "base.html" %}

{% block title %}ë‚´ ì²¨ì‚­ - MOMOAI v4.0{% endblock %}

{% block content %}
<div class="max-w-7xl mx-auto">
    <!-- Header -->
    <div class="mb-6 flex items-center justify-between">
        <div>
            <h2 class="text-3xl font-bold text-gray-800">ë‚´ ì²¨ì‚­ ({{ essays|length }})</h2>
            <p class="text-gray-600 mt-1">ì œì¶œí•œ ì²¨ì‚­ ê¸°ë¡ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
        </div>
        <a href="{{ url_for('student.submit_essay') }}"
           class="bg-blue-600 hover:bg-blue-700 text-white font-medium px-6 py-3 rounded-lg transition duration-200">
            + ìƒˆ ê³¼ì œ ì œì¶œ
        </a>
    </div>

    <!-- ì²¨ì‚­ ëª©ë¡ -->
    {% if essays %}
    <div class="grid grid-cols-1 gap-4">
        {% for essay in essays %}
        <div class="bg-white rounded-lg shadow hover:shadow-md transition duration-200">
            <a href="{{ url_for('student.view_essay', essay_id=essay.essay_id) }}"
               class="block p-6">
                <div class="flex items-start justify-between mb-3">
                    <div class="flex-1">
                        <h3 class="text-xl font-medium text-gray-800 hover:text-blue-600 mb-2">
                            {{ essay.title }}
                        </h3>
                        <div class="flex items-center gap-3 text-sm text-gray-600">
                            <span>ğŸ“… {{ essay.created_at.strftime('%Yë…„ %mì›” %dì¼') }}</span>
                            <span>ğŸ‘¨â€ğŸ« {{ essay.user.name }} ê°•ì‚¬</span>
                            {% if essay.is_finalized %}
                            <span>âœ… {{ essay.finalized_at.strftime('%Yë…„ %mì›” %dì¼') }} ì™„ë£Œ</span>
                            {% endif %}
                        </div>
                    </div>
                    <div class="flex flex-col items-end gap-2">
                        <span class="px-3 py-1 text-sm font-medium rounded
                            {% if essay.is_finalized %}bg-green-100 text-green-800
                            {% else %}bg-yellow-100 text-yellow-800{% endif %}">
                            {% if essay.is_finalized %}ì²¨ì‚­ ì™„ë£Œ{% else %}ì§„í–‰ ì¤‘{% endif %}
                        </span>
                        {% if essay.is_finalized and essay.total_score %}
                        <span class="px-3 py-1 text-sm font-medium bg-blue-100 text-blue-800 rounded">
                            ì´ì : {{ essay.total_score }}ì 
                        </span>
                        {% endif %}
                    </div>
                </div>

                {% if essay.is_finalized and essay.overall_feedback %}
                <div class="bg-gray-50 rounded-lg p-4 mt-3">
                    <p class="text-sm text-gray-700 line-clamp-2">
                        <span class="font-medium">ì¢…í•© í‰ê°€:</span> {{ essay.overall_feedback[:200] }}{% if essay.overall_feedback|length > 200 %}...{% endif %}
                    </p>
                </div>
                {% endif %}
            </a>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <div class="bg-white rounded-lg shadow p-12 text-center">
        <div class="text-6xl mb-4">ğŸ“</div>
        <h3 class="text-xl font-medium text-gray-800 mb-2">ì œì¶œí•œ ì²¨ì‚­ì´ ì—†ìŠµë‹ˆë‹¤</h3>
        <p class="text-gray-600 mb-6">ì²« ë²ˆì§¸ ì²¨ì‚­ì„ ì œì¶œí•´ë³´ì„¸ìš”!</p>
        <a href="{{ url_for('student.submit_essay') }}"
           class="inline-block bg-blue-600 hover:bg-blue-700 text-white font-medium px-6 py-3 rounded-lg transition duration-200">
            ê³¼ì œ ì œì¶œí•˜ê¸°
        </a>
    </div>
    {% endif %}
</div>
{% endblock %}
