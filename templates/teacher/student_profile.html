{% extends "base.html" %}

{% block title %}{{ student.name }} í•™ìƒ í”„ë¡œí•„ - MOMOAI v4.0{% endblock %}

{% block content %}
<div class="max-w-7xl mx-auto">
    <!-- Header -->
    <div class="mb-6">
        <a href="{{ url_for('teacher.index') }}"
           class="text-blue-600 hover:text-blue-800 font-medium mb-2 inline-block">
            â† ëŒ€ì‹œë³´ë“œë¡œ
        </a>
        <div>
            <h2 class="text-3xl font-bold text-gray-800">{{ student.name }} í•™ìƒ í”„ë¡œí•„</h2>
            <p class="text-gray-600 mt-1">í•™ìƒ ID: {{ student.student_id[:8] }}</p>
        </div>
    </div>

    {% if profile %}
    <!-- ì£¼ìš” íŠ¹ì§• ì¹´ë“œ -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
        <!-- ë…ì„œ ì—­ëŸ‰ -->
        <div class="bg-gradient-to-br from-blue-50 to-blue-100 rounded-lg shadow p-5 border border-blue-200">
            <div class="flex items-center justify-between mb-3">
                <h3 class="text-sm font-semibold text-blue-900">ğŸ“š ë…ì„œ ì—­ëŸ‰</h3>
            </div>
            <div class="text-3xl font-bold text-blue-700 mb-1">
                {% if profile.reading_competency %}
                {{ profile.reading_competency }}/5
                {% else %}
                -
                {% endif %}
            </div>
            <div class="text-xs text-blue-600">
                {% if profile.weekly_reading_amount %}
                {{ profile.weekly_reading_amount }}
                {% endif %}
            </div>
        </div>

        <!-- ìˆ˜ì—… ê²½í—˜ -->
        <div class="bg-gradient-to-br from-green-50 to-green-100 rounded-lg shadow p-5 border border-green-200">
            <div class="flex items-center justify-between mb-3">
                <h3 class="text-sm font-semibold text-green-900">âœï¸ ìˆ˜ì—… ê²½í—˜</h3>
            </div>
            <div class="text-lg font-bold text-green-700 mb-1">
                {% if profile.reading_experience %}
                {{ profile.reading_experience }}
                {% else %}
                ì—†ìŒ
                {% endif %}
            </div>
            <div class="text-xs text-green-600">ë…ì„œë…¼ìˆ  ìˆ˜ì—…</div>
        </div>

        <!-- ì§„í•™ ëª©í‘œ -->
        <div class="bg-gradient-to-br from-purple-50 to-purple-100 rounded-lg shadow p-5 border border-purple-200">
            <div class="flex items-center justify-between mb-3">
                <h3 class="text-sm font-semibold text-purple-900">ğŸ¯ ì§„í•™ ëª©í‘œ</h3>
            </div>
            <div class="text-sm font-medium text-purple-700 line-clamp-2">
                {% if profile.academic_goals_list %}
                {{ profile.academic_goals_list[0] }}
                {% if profile.academic_goals_list|length > 1 %}
                <span class="text-xs">ì™¸ {{ profile.academic_goals_list|length - 1 }}ê°œ</span>
                {% endif %}
                {% else %}
                ë¯¸ì •
                {% endif %}
            </div>
        </div>

        <!-- ì„±í–¥ -->
        <div class="bg-gradient-to-br from-orange-50 to-orange-100 rounded-lg shadow p-5 border border-orange-200">
            <div class="flex items-center justify-between mb-3">
                <h3 class="text-sm font-semibold text-orange-900">ğŸ‘¤ í•™ìƒ ì„±í–¥</h3>
            </div>
            <div class="text-sm font-medium text-orange-700 line-clamp-2">
                {% if profile.personality_traits_list %}
                {{ profile.personality_traits_list[0] }}
                {% if profile.personality_traits_list|length > 1 %}
                <span class="text-xs">ì™¸ {{ profile.personality_traits_list|length - 1 }}ê°œ</span>
                {% endif %}
                {% else %}
                -
                {% endif %}
            </div>
        </div>
    </div>

    <!-- ìƒì„¸ ì •ë³´ ì„¹ì…˜ -->
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6">
        <!-- ê¸°ë³¸ ì •ë³´ -->
        <div class="bg-white rounded-lg shadow">
            <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-lg font-bold text-gray-800">ê¸°ë³¸ ì •ë³´</h3>
            </div>
            <div class="p-6 space-y-3 text-sm">
                <div>
                    <p class="text-gray-600 mb-1">ì¬í•™ í•™êµ</p>
                    <p class="font-medium text-gray-800">{{ profile.current_school or '-' }}</p>
                </div>
                <div>
                    <p class="text-gray-600 mb-1">í•™ë¶€ëª¨ ì—°ë½ì²˜</p>
                    <p class="font-medium text-gray-800">{{ profile.parent_contact or '-' }}</p>
                </div>
                <div>
                    <p class="text-gray-600 mb-1">ì£¼ì†Œ</p>
                    <p class="font-medium text-gray-800">{{ profile.address or '-' }}</p>
                </div>
                <div>
                    <p class="text-gray-600 mb-1">ìœ ì… ê²½ë¡œ</p>
                    <p class="font-medium text-gray-800">{{ profile.referral_source or '-' }}</p>
                </div>
                {% if profile.sibling_info %}
                <div>
                    <p class="text-gray-600 mb-1">í˜•ì œìë§¤</p>
                    <p class="font-medium text-gray-800">{{ profile.sibling_info }}</p>
                </div>
                {% endif %}
            </div>
        </div>

        <!-- ë…ì„œ ì„±í–¥ -->
        <div class="bg-white rounded-lg shadow">
            <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-lg font-bold text-gray-800">ë…ì„œ ì„±í–¥</h3>
            </div>
            <div class="p-6 space-y-3 text-sm">
                <div>
                    <p class="text-gray-600 mb-2">ì„ í˜¸ ë…ì„œ ë¶„ì•¼</p>
                    <div class="flex flex-wrap gap-2">
                        {% for genre in profile.preferred_genres_list %}
                        <span class="bg-blue-100 text-blue-800 text-xs font-medium px-2.5 py-0.5 rounded">{{ genre }}</span>
                        {% else %}
                        <p class="text-gray-500">-</p>
                        {% endfor %}
                    </div>
                </div>
                <div>
                    <p class="text-gray-600 mb-2">í•™ìƒ ì„±í–¥</p>
                    <div class="flex flex-wrap gap-2">
                        {% for trait in profile.personality_traits_list %}
                        <span class="bg-green-100 text-green-800 text-xs font-medium px-2.5 py-0.5 rounded">{{ trait }}</span>
                        {% else %}
                        <p class="text-gray-500">-</p>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>

        <!-- ìˆ˜ì—… ëª©í‘œ -->
        <div class="bg-white rounded-lg shadow">
            <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-lg font-bold text-gray-800">ìˆ˜ì—… ëª©í‘œ</h3>
            </div>
            <div class="p-6 space-y-3 text-sm">
                <div>
                    <p class="text-gray-600 mb-1">ì£¼ìš” í–¥ìƒ ëª©í‘œ</p>
                    <p class="font-medium text-gray-800">{{ profile.main_improvement_goal or '-' }}</p>
                </div>
                <div>
                    <p class="text-gray-600 mb-1">ì„ í˜¸ ìˆ˜ì—… ìŠ¤íƒ€ì¼</p>
                    <p class="font-medium text-gray-800">{{ profile.preferred_class_style or '-' }}</p>
                </div>
                {% if profile.teacher_request %}
                <div>
                    <p class="text-gray-600 mb-1">ê°•ì‚¬ ìš”ì²­ì‚¬í•­</p>
                    <p class="font-medium text-gray-800 bg-yellow-50 p-2 rounded border border-yellow-200">{{ profile.teacher_request }}</p>
                </div>
                {% endif %}
            </div>
        </div>
    </div>

    <!-- ì§„ë¡œ/ì§„í•™ ì •ë³´ -->
    {% if profile.academic_goals_list or profile.career_interests_list or profile.education_info_needs_list %}
    <div class="bg-white rounded-lg shadow mb-6">
        <div class="px-6 py-4 border-b border-gray-200">
            <h3 class="text-lg font-bold text-gray-800">ì§„ë¡œ ë° ì§„í•™ ì •ë³´</h3>
        </div>
        <div class="p-6 grid grid-cols-1 md:grid-cols-3 gap-6 text-sm">
            <div>
                <p class="text-gray-600 mb-2 font-medium">ì§„í•™ ëª©í‘œ</p>
                <div class="space-y-1">
                    {% for goal in profile.academic_goals_list %}
                    <p class="text-gray-800">â€¢ {{ goal }}</p>
                    {% else %}
                    <p class="text-gray-500">-</p>
                    {% endfor %}
                </div>
            </div>
            <div>
                <p class="text-gray-600 mb-2 font-medium">ì§„ë¡œ ê´€ì‹¬ ë¶„ì•¼</p>
                <div class="space-y-1">
                    {% for interest in profile.career_interests_list %}
                    <p class="text-gray-800">â€¢ {{ interest }}</p>
                    {% else %}
                    <p class="text-gray-500">-</p>
                    {% endfor %}
                </div>
            </div>
            <div>
                <p class="text-gray-600 mb-2 font-medium">í•„ìš”í•œ êµìœ¡ ì •ë³´</p>
                <div class="space-y-1">
                    {% for need in profile.education_info_needs_list %}
                    <p class="text-gray-800">â€¢ {{ need }}</p>
                    {% else %}
                    <p class="text-gray-500">-</p>
                    {% endfor %}
                </div>
            </div>
        </div>
        {% if profile.other_interests %}
        <div class="px-6 pb-6">
            <p class="text-gray-600 mb-1 font-medium text-sm">ê¸°íƒ€ ê´€ì‹¬ì‚¬í•­</p>
            <p class="text-gray-800 text-sm bg-gray-50 p-3 rounded">{{ profile.other_interests }}</p>
        </div>
        {% endif %}
    </div>
    {% endif %}

    {% else %}
    <!-- í”„ë¡œí•„ ì—†ìŒ -->
    <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-8 text-center">
        <div class="text-5xl mb-4">ğŸ“‹</div>
        <p class="text-gray-700 font-medium">ì•„ì§ ê¸°ì´ˆ ì¡°ì‚¬ í”„ë¡œí•„ì´ ì‘ì„±ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.</p>
        <p class="text-gray-600 text-sm mt-2">ê´€ë¦¬ìê°€ í”„ë¡œí•„ì„ ì‘ì„±í•˜ë©´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.</p>
    </div>
    {% endif %}

    <!-- ìƒë‹´ ì´ë ¥ ì„¹ì…˜ -->
    <div class="bg-white rounded-lg shadow mt-6">
        <div class="px-6 py-4 border-b border-gray-200 flex items-center justify-between">
            <h3 class="text-lg font-bold text-gray-800">ğŸ’¬ ìƒë‹´ ì´ë ¥</h3>
            <span class="text-sm text-gray-600">ì´ {{ consultations|length }}ê±´</span>
        </div>
        <div class="p-6">
            {% if consultations %}
            <div class="space-y-4">
                {% for consultation in consultations %}
                <div class="border border-gray-200 rounded-lg p-4 hover:border-blue-300 transition duration-200">
                    <div class="flex items-start justify-between mb-2">
                        <div class="flex-1">
                            <a href="{{ url_for('teacher.consultation_detail', consultation_id=consultation.consultation_id) }}"
                               class="text-blue-600 hover:text-blue-800 font-medium">
                                {{ consultation.title }}
                            </a>
                            <div class="flex items-center gap-3 mt-1 text-xs text-gray-600">
                                <span>ğŸ“… {{ consultation.consultation_date.strftime('%Y-%m-%d') }}</span>
                                <span>ğŸ‘¤ {{ consultation.counselor.name }}</span>
                                <span class="bg-purple-100 text-purple-800 px-2 py-0.5 rounded">{{ consultation.major_category }}</span>
                                {% if consultation.sub_category %}
                                <span class="bg-gray-100 text-gray-700 px-2 py-0.5 rounded">{{ consultation.sub_category }}</span>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                    <p class="text-sm text-gray-700 line-clamp-2">{{ consultation.content }}</p>
                </div>
                {% endfor %}
            </div>
            {% else %}
            <div class="text-center py-12 text-gray-500">
                <div class="text-4xl mb-3">ğŸ“­</div>
                <p>ì•„ì§ ìƒë‹´ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤.</p>
            </div>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}
