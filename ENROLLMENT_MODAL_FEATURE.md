# 수강생 정보 모달 기능 구현 완료

## 📋 구현 내용

### 기능 개요
수업 관리 페이지에서 **수강생 인원을 클릭**하면 **모달 팝업**이 나타나 학생 이름과 상세정보를 확인할 수 있습니다.

## 🎯 주요 기능

### 1. 클릭 가능한 수강생 인원 표시
- **위치**: 수업 관리 테이블의 "수강생" 열
- **형식**: 👥 3/15 (현재인원/정원)
- **스타일**: 파란색 텍스트, hover 시 밑줄
- **동작**: 클릭 시 학생 상세정보 모달 표시

### 2. 학생 상세정보 모달

#### 📊 통계 카드 (4개)
1. **전체 수강생**: 총 등록 학생 수
2. **수강 중**: 현재 active 상태 학생 수
3. **평균 출석률**: 전체 학생의 평균 출석률 (%)
4. **정원**: 수업 최대 정원

#### 📋 학생 테이블 (8개 컬럼)
1. **학생명**: 학생 이름 (굵은 글씨)
2. **학년**: 초1~고3
3. **등급**: A/B/C/VIP (색상 배지)
   - A등급: 빨간색
   - B등급: 파란색
   - C등급: 초록색
   - VIP: 보라색
4. **연락처**: 전화번호
5. **출석률**: 백분율 (색상 구분)
   - 80% 이상: 초록색
   - 60-79%: 노란색
   - 60% 미만: 빨간색
6. **출석/지각/결석**: ✓/△/✗ 아이콘으로 표시
7. **상태**: 수강 중/완료/중도 포기 (배지)
8. **등록일**: YYYY-MM-DD 형식

### 3. 모달 인터랙션

#### 열기
- 수업 관리 테이블에서 수강생 인원 클릭
- 로딩 스피너 표시
- API에서 데이터 가져오기
- 데이터 렌더링

#### 닫기 방법 (3가지)
1. 우측 상단 "×" 버튼 클릭
2. "닫기" 버튼 클릭
3. ESC 키 누르기
4. 모달 배경(외부) 클릭

#### 액션 버튼
- **닫기**: 모달 닫기
- **수강생 관리 →**: 해당 수업의 수강생 관리 페이지로 이동

## 📂 수정된 파일

### 1. `templates/admin/courses.html`
**변경 사항:**
- 수강생 열을 클릭 가능한 버튼으로 변경
- 학생 상세정보 모달 HTML 추가
- JavaScript 함수 추가:
  - `showStudentModal(courseId)`: 모달 표시 및 데이터 로드
  - `closeStudentModal()`: 모달 닫기
  - ESC 키 및 배경 클릭 이벤트 리스너

### 2. `app/admin/routes.py`
**추가된 라우트:**
```python
@admin_bp.route('/courses/<course_id>/students-data')
@login_required
@requires_permission_level(2)
def get_students_data(course_id):
    """수강생 데이터 조회 (JSON)"""
```

**반환 데이터 구조:**
```json
{
    "course_name": "수업명",
    "total_students": 3,
    "active_students": 3,
    "avg_attendance": 85.5,
    "max_students": 15,
    "students": [
        {
            "name": "학생명",
            "grade": "초3",
            "tier": "A",
            "phone": "010-1234-5678",
            "attendance_rate": 90.5,
            "attended": 10,
            "late": 1,
            "absent": 2,
            "status": "active",
            "enrolled_at": "2026-02-01"
        }
    ]
}
```

## 🎨 UI/UX 디자인

### 색상 시스템

#### 등급 배지
- **A등급**: `bg-red-100 text-red-800`
- **B등급**: `bg-blue-100 text-blue-800`
- **C등급**: `bg-green-100 text-green-800`
- **VIP**: `bg-purple-100 text-purple-800`

#### 상태 배지
- **수강 중**: `bg-green-100 text-green-800`
- **완료**: `bg-gray-100 text-gray-800`
- **중도 포기**: `bg-red-100 text-red-800`

#### 출석률 색상
- **80% 이상**: `text-green-600` (우수)
- **60-79%**: `text-yellow-600` (보통)
- **60% 미만**: `text-red-600` (미흡)

#### 통계 카드
- **전체 수강생**: 파란색 (`bg-blue-50`)
- **수강 중**: 초록색 (`bg-green-50`)
- **평균 출석률**: 보라색 (`bg-purple-50`)
- **정원**: 노란색 (`bg-yellow-50`)

### 애니메이션
- **로딩 스피너**: 회전 애니메이션
- **모달 배경**: 반투명 회색 오버레이
- **호버 효과**: 테이블 행 배경 변화

## 🚀 사용 방법

### 1. 수업 관리 페이지 접속
```
관리자 대시보드 → 📚 수업 관리
또는 URL: http://localhost:5000/admin/courses
```

### 2. 수강생 인원 클릭
```
수업 목록에서 "수강생" 열의 숫자 클릭
예: 👥 3/15
```

### 3. 모달에서 정보 확인
```
- 통계 카드에서 전체 현황 파악
- 테이블에서 개별 학생 정보 확인
- 출석률, 연락처, 등급 등 상세 정보 확인
```

### 4. 수강생 관리로 이동 (선택)
```
모달 하단 "수강생 관리 →" 버튼 클릭
→ 학생 추가/제외 페이지로 이동
```

## 📊 데이터 처리 흐름

```
1. 사용자: 수강생 인원 클릭
   ↓
2. JavaScript: showStudentModal(courseId) 호출
   ↓
3. Frontend: 모달 표시 + 로딩 스피너
   ↓
4. API 요청: GET /admin/courses/{course_id}/students-data
   ↓
5. Backend:
   - CourseEnrollment 조회
   - 통계 계산 (total, active, avg_attendance)
   - 학생 데이터 JSON 생성
   ↓
6. Frontend: JSON 수신 및 파싱
   ↓
7. DOM 업데이트:
   - 통계 카드 값 업데이트
   - 학생 테이블 행 생성
   - 로딩 숨기고 콘텐츠 표시
```

## 🧪 테스트 시나리오

### Scenario 1: 수강생이 있는 수업
```
① 수업 관리에서 수강생이 있는 수업 찾기
② 수강생 인원 (예: 👥 3/15) 클릭
③ 모달이 열리고 로딩 표시
④ 3명의 학생 정보가 테이블에 표시됨
⑤ 통계 카드 확인 (전체 3, 수강중 3, 평균 출석률 등)
⑥ 학생 클릭 시 아무 동작 없음 (향후 확장 가능)
⑦ "닫기" 버튼으로 모달 닫기
```

### Scenario 2: 수강생이 없는 수업
```
① 새로 생성한 수업 찾기
② 수강생 인원 (👥 0/15) 클릭
③ 모달이 열리고 로딩 표시
④ "등록된 수강생이 없습니다" 메시지 표시
⑤ 통계 카드: 전체 0, 평균 출석률 0%
⑥ "수강생 관리 →" 버튼으로 학생 추가 페이지 이동
```

### Scenario 3: 모달 닫기
```
방법 1: "×" 버튼 클릭
방법 2: "닫기" 버튼 클릭
방법 3: ESC 키 누르기
방법 4: 모달 바깥 회색 영역 클릭
```

## 📝 향후 개선 가능 사항

- [ ] 학생 이름 클릭 시 학생 상세 페이지로 이동
- [ ] 학생 검색/필터링 기능
- [ ] 정렬 기능 (이름순, 출석률순, 등록일순)
- [ ] CSV/Excel 내보내기
- [ ] 학생별 간단한 메모 표시
- [ ] 학부모 연락처 표시
- [ ] 최근 출석 기록 표시
- [ ] 미납 결제 경고 표시

## 🎯 핵심 가치

### 관리자 관점
- ✨ 수업별 수강생을 빠르게 확인
- ✨ 페이지 이동 없이 모달로 즉시 확인
- ✨ 출석률로 학생 관리 상태 파악
- ✨ 한눈에 보는 통계 대시보드

### UX 관점
- ✨ 클릭 한 번으로 상세 정보 표시
- ✨ 로딩 상태 명확하게 표시
- ✨ 다양한 닫기 방법 지원
- ✨ 반응형 테이블 디자인

### 기술적 관점
- ✨ AJAX로 비동기 데이터 로드
- ✨ JSON API 엔드포인트
- ✨ 모달 재사용 가능한 구조
- ✨ 확장 가능한 데이터 형식

## 🔗 관련 기능

### 연동된 기능
1. **수업 관리** (`admin.courses`)
   - 수강생 인원 클릭 → 모달 표시

2. **수강생 관리** (`admin.manage_students`)
   - 모달에서 "수강생 관리" 버튼 → 이동

3. **수업 상세** (`admin.course_detail`)
   - "상세보기" 버튼으로 접근 가능

## 💡 사용 팁

1. **빠른 확인**: 수업 목록에서 바로 수강생 정보 확인
2. **출석률 체크**: 색상으로 출석률 상태 즉시 파악
3. **학생 관리**: 모달에서 바로 수강생 관리 페이지로 이동
4. **키보드 단축키**: ESC 키로 빠르게 모달 닫기

---

**구현 완료:** 2026-02-09
**개발자:** Claude Sonnet 4.5
**버전:** MOMOAI v4.0

**테스트 상태:**
- ✅ API 엔드포인트 생성 완료
- ✅ 모달 UI 구현 완료
- ✅ JavaScript 인터랙션 완료
- ✅ 통계 계산 로직 완료
- 🔄 서버 실행 중 - 테스트 가능
